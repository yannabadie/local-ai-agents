# CVE-2025-6514 - MCP Remote Server RCE

## Overview

| Field | Value |
|-------|-------|
| **CVE ID** | CVE-2025-6514 |
| **CVSS Score** | 9.6 (Critical) |
| **Affected Component** | @anthropic-ai/mcp-remote |
| **Vulnerable Versions** | < 0.1.9 |
| **Fixed Version** | 0.1.9+ |
| **Discovery Date** | January 2026 |

## Vulnerability Description

The `@anthropic-ai/mcp-remote` npm package allows connecting MCP (Model Context Protocol) clients to remote servers. Prior to version 0.1.9, the package contains a **command injection vulnerability** that enables Remote Code Execution (RCE).

### Root Cause

The vulnerability exists in the URL parsing mechanism used to connect to remote MCP servers. User-supplied URLs are insufficiently sanitized before being passed to shell commands, allowing attackers to inject arbitrary commands.

### Attack Vector

1. Attacker crafts a malicious MCP server URL containing shell metacharacters
2. Victim's MCP client connects to the malicious URL
3. Shell injection is triggered during the connection process
4. Arbitrary code executes with the privileges of the MCP client process

## Impact

- **Confidentiality**: High - Attacker can read files, environment variables, credentials
- **Integrity**: High - Attacker can modify files, install backdoors
- **Availability**: High - Attacker can crash services, delete data

### Attack Scenarios

1. **Malicious Server**: Attacker hosts a fake MCP server with a weaponized URL
2. **Man-in-the-Middle**: Attacker intercepts MCP server discovery and injects malicious URL
3. **Social Engineering**: Attacker convinces victim to configure a malicious MCP server

## Reproduction Environment

### Prerequisites

- Node.js 18+
- npm
- Vulnerable mcp-remote version (< 0.1.9)

### Lab Setup

```bash
# Create isolated test environment
mkdir mcp-vuln-lab && cd mcp-vuln-lab

# Install vulnerable version
npm install @anthropic-ai/mcp-remote@0.1.8

# Verify installation
npm list @anthropic-ai/mcp-remote
```

## Proof of Concept

See `exploit.py` for the demonstration code.

**WARNING**: This PoC is for authorized security testing only. Do not use against systems you don't own or have permission to test.

## Indicators of Compromise

- Unexpected child processes spawned by MCP client
- Suspicious network connections from MCP client
- Unusual file access patterns
- Modified configuration files

## Detection

```bash
# Check for vulnerable version
npm list @anthropic-ai/mcp-remote 2>/dev/null | grep -E "0\\.1\\.[0-8]"

# Monitor for exploitation attempts (Linux)
auditctl -w /usr/bin/bash -p x -k mcp_exploit

# Check running processes for suspicious MCP activity
ps aux | grep -i mcp
```

## References

- [NVD Entry](https://nvd.nist.gov/vuln/detail/CVE-2025-6514)
- [GitHub Advisory](https://github.com/anthropics/mcp-remote/security/advisories)
- [Model Context Protocol Specification](https://modelcontextprotocol.io/)
- [OWASP Command Injection](https://owasp.org/www-community/attacks/Command_Injection)

## Timeline

| Date | Event |
|------|-------|
| 2025-12-XX | Vulnerability discovered |
| 2025-12-XX | Vendor notified |
| 2026-01-XX | Patch released (v0.1.9) |
| 2026-01-XX | CVE assigned |
| 2026-01-19 | PoC developed (this lab) |

## Credits

- Original discovery: Security researchers
- PoC adaptation: local-ai-agents project (security research lab)

## Legal Disclaimer

This proof-of-concept is provided for educational and authorized security testing purposes only. Unauthorized access to computer systems is illegal. The authors are not responsible for any misuse of this information.
